<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>New Audit - Retail Audit App</title>
    <style>
      :root {
        --primary-50: #eff6ff;
        --primary-100: #dbeafe;
        --primary-500: #3b82f6;
        --primary-600: #2563eb;
        --primary-700: #1d4ed8;
        --success-50: #f0fdf4;
        --success-100: #dcfce7;
        --success-500: #22c55e;
        --success-600: #16a34a;
        --warning-50: #fffbeb;
        --warning-100: #fef3c7;
        --warning-500: #f59e0b;
        --warning-600: #d97706;
        --error-50: #fef2f2;
        --error-100: #fee2e2;
        --error-500: #ef4444;
        --error-600: #dc2626;
        --neutral-0: #ffffff;
        --neutral-50: #f9fafb;
        --neutral-100: #f3f4f6;
        --neutral-200: #e5e7eb;
        --neutral-300: #d1d5db;
        --neutral-400: #9ca3af;
        --neutral-500: #6b7280;
        --neutral-600: #4b5563;
        --neutral-700: #374151;
        --neutral-800: #1f2937;
        --neutral-900: #111827;
        --text-xs: 0.75rem;
        --text-sm: 0.875rem;
        --text-base: 1rem;
        --text-lg: 1.125rem;
        --text-xl: 1.25rem;
        --text-2xl: 1.5rem;
        --leading-tight: 1.25;
        --leading-normal: 1.5;
        --font-normal: 400;
        --font-medium: 500;
        --font-semibold: 600;
        --font-bold: 700;
        --space-1: 0.25rem;
        --space-2: 0.5rem;
        --space-3: 0.75rem;
        --space-4: 1rem;
        --space-5: 1.25rem;
        --space-6: 1.5rem;
        --space-8: 2rem;
        --radius-sm: 0.25rem;
        --radius-md: 0.375rem;
        --radius-lg: 0.5rem;
        --radius-xl: 0.75rem;
        --radius-2xl: 1rem;
        --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }

      .audit-phone-frame {
        width: 375px;
        min-height: 812px;
        background: var(--neutral-0);
        border-radius: 40px;
        overflow: hidden;
        position: relative;
        box-shadow: var(--shadow-lg);
        border: 1px solid var(--neutral-200);
        margin: var(--space-8);
        display: flex;
        flex-direction: column;
      }
      
      .audit-header {
        background: linear-gradient(135deg, var(--primary-600) 0%, #8b5cf6 100%);
        color: var(--neutral-0);
        padding: var(--space-4);
        position: sticky;
        top: 0;
        z-index: 10;
      }
      
      .header-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--space-3);
      }
      
      .audit-title {
        font-size: var(--text-lg);
        font-weight: var(--font-semibold);
        margin: 0;
      }
      
      .header-button {
        background: rgba(255, 255, 255, 0.2);
        border: none;
        border-radius: var(--radius-lg);
        padding: var(--space-2);
        color: var(--neutral-0);
        cursor: pointer;
        transition: all 0.2s ease;
      }
      
      .header-button:hover {
        background: rgba(255, 255, 255, 0.3);
      }
      
      .progress-bar {
        background: rgba(255, 255, 255, 0.2);
        border-radius: var(--radius-xl);
        height: 6px;
        overflow: hidden;
      }
      
      .progress-fill {
        background: var(--neutral-0);
        height: 100%;
        border-radius: var(--radius-xl);
        transition: width 0.3s ease;
        width: 25%;
      }
      
      .progress-text {
        font-size: var(--text-xs);
        opacity: 0.9;
        margin-top: var(--space-2);
        text-align: center;
      }
      
      .audit-content {
        flex: 1;
        overflow-y: auto;
        background: var(--neutral-50);
        scrollbar-width: none;
        -ms-overflow-style: none;
      }
      
      .audit-content::-webkit-scrollbar {
        display: none;
      }
      
      .form-section {
        background: var(--neutral-0);
        margin: var(--space-4);
        border-radius: var(--radius-lg);
        padding: var(--space-4);
        box-shadow: var(--shadow-sm);
        border: 1px solid var(--neutral-200);
      }
      
      .section-header {
        display: flex;
        align-items: center;
        margin-bottom: var(--space-4);
      }
      
      .section-icon {
        width: 40px;
        height: 40px;
        border-radius: var(--radius-lg);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: var(--space-3);
        font-size: var(--text-lg);
        color: var(--neutral-0);
      }
      
      .section-title {
        font-size: var(--text-base);
        font-weight: var(--font-semibold);
        color: var(--neutral-800);
        margin: 0;
      }
      
      .form-group {
        margin-bottom: var(--space-4);
      }
      
      .form-label {
        display: block;
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
        color: var(--neutral-700);
        margin-bottom: var(--space-2);
      }
      
      .form-input {
        width: 100%;
        padding: var(--space-3);
        border: 2px solid var(--neutral-200);
        border-radius: var(--radius-lg);
        font-size: var(--text-base);
        transition: all 0.2s ease;
        background: var(--neutral-50);
        box-sizing: border-box;
      }
      
      .form-input:focus {
        outline: none;
        border-color: var(--primary-500);
        background: var(--neutral-0);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }
      
      .form-select {
        width: 100%;
        padding: var(--space-3);
        border: 2px solid var(--neutral-200);
        border-radius: var(--radius-lg);
        font-size: var(--text-base);
        background: var(--neutral-50);
        cursor: pointer;
        transition: all 0.2s ease;
      }
      
      .form-select:focus {
        outline: none;
        border-color: var(--primary-500);
        background: var(--neutral-0);
      }
      
      .form-textarea {
        width: 100%;
        padding: var(--space-3);
        border: 2px solid var(--neutral-200);
        border-radius: var(--radius-lg);
        font-size: var(--text-base);
        background: var(--neutral-50);
        resize: vertical;
        min-height: 80px;
        font-family: inherit;
        transition: all 0.2s ease;
        box-sizing: border-box;
      }
      
      .form-textarea:focus {
        outline: none;
        border-color: var(--primary-500);
        background: var(--neutral-0);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }
      
      .checkbox-group {
        display: flex;
        flex-direction: column;
        gap: var(--space-3);
      }
      
      .checkbox-item {
        display: flex;
        align-items: center;
        padding: var(--space-3);
        background: var(--neutral-50);
        border-radius: var(--radius-lg);
        border: 1px solid var(--neutral-200);
        cursor: pointer;
        transition: all 0.2s ease;
      }
      
      .checkbox-item:hover {
        background: var(--neutral-100);
      }
      
      .checkbox-item.checked {
        background: var(--success-50);
        border-color: var(--success-500);
      }
      
      .checkbox-input {
        margin-right: var(--space-3);
        width: 18px;
        height: 18px;
        accent-color: var(--success-600);
      }
      
      .checkbox-label {
        flex: 1;
        font-size: var(--text-sm);
        color: var(--neutral-700);
        cursor: pointer;
      }
      
      .checkbox-status {
        font-size: var(--text-xs);
        padding: var(--space-1) var(--space-2);
        border-radius: var(--radius-md);
        font-weight: var(--font-medium);
      }
      
      .status-pass {
        background: var(--success-100);
        color: var(--success-600);
      }
      
      .status-fail {
        background: var(--error-100);
        color: var(--error-600);
      }
      
      .status-na {
        background: var(--neutral-100);
        color: var(--neutral-600);
      }
      
      .photo-upload {
        border: 2px dashed var(--neutral-300);
        border-radius: var(--radius-lg);
        padding: var(--space-6);
        text-align: center;
        background: var(--neutral-50);
        cursor: pointer;
        transition: all 0.2s ease;
      }
      
      .photo-upload:hover {
        border-color: var(--primary-500);
        background: var(--primary-50);
      }
      
      .photo-upload.has-photos {
        border-style: solid;
        border-color: var(--success-500);
        background: var(--success-50);
      }
      
      .upload-icon {
        font-size: var(--text-2xl);
        color: var(--neutral-400);
        margin-bottom: var(--space-2);
      }
      
      .upload-text {
        font-size: var(--text-sm);
        color: var(--neutral-600);
        margin-bottom: var(--space-1);
      }
      
      .upload-subtext {
        font-size: var(--text-xs);
        color: var(--neutral-500);
      }
      
      .photo-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: var(--space-2);
        margin-top: var(--space-3);
      }
      
      .photo-item {
        aspect-ratio: 1;
        background: var(--neutral-200);
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
      }
      
      .photo-placeholder {
        color: var(--neutral-500);
        font-size: var(--text-lg);
      }
      
      .remove-photo {
        position: absolute;
        top: var(--space-1);
        right: var(--space-1);
        background: var(--error-500);
        color: var(--neutral-0);
        border: none;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: var(--text-xs);
      }
      
      .form-actions {
        background: var(--neutral-0);
        padding: var(--space-4);
        border-top: 1px solid var(--neutral-200);
        display: flex;
        gap: var(--space-3);
        position: sticky;
        bottom: 0;
      }
      
      .action-btn {
        flex: 1;
        padding: var(--space-3);
        border-radius: var(--radius-lg);
        font-size: var(--text-base);
        font-weight: var(--font-semibold);
        cursor: pointer;
        transition: all 0.2s ease;
        border: none;
      }
      
      .btn-secondary {
        background: var(--neutral-100);
        color: var(--neutral-700);
        border: 1px solid var(--neutral-200);
      }
      
      .btn-secondary:hover {
        background: var(--neutral-200);
      }
      
      .btn-primary {
        background: var(--success-600);
        color: var(--neutral-0);
      }
      
      .btn-primary:hover {
        background: var(--success-700);
        transform: translateY(-1px);
      }
      
      .btn-primary:disabled {
        background: var(--neutral-300);
        cursor: not-allowed;
        transform: none;
      }
      
      .floating-scan {
        position: fixed;
        bottom: 100px;
        right: 20px;
        background: var(--primary-600);
        color: var(--neutral-0);
        border: none;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: var(--shadow-lg);
        transition: all 0.2s ease;
        z-index: 20;
      }
      
      .floating-scan:hover {
        background: var(--primary-700);
        transform: scale(1.1);
      }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  </head>
  <body style="background: var(--neutral-100); margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
    <div class="audit-phone-frame">
      <!-- Header -->
      <div class="audit-header">
        <div class="header-controls">
          <button onclick="goBack()" class="header-button">
            <i class="fas fa-arrow-left" style="font-size: var(--text-xl);"></i>
          </button>
          <h1 class="audit-title">New Audit</h1>
          <button onclick="saveAsDraft()" class="header-button">
            <i class="fas fa-save" style="font-size: var(--text-xl);"></i>
          </button>
        </div>
        
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="progress-text" id="progressText">Step 1 of 4 - Store Information</div>
      </div>

      <!-- Form Content -->
      <div class="audit-content">
        <!-- Store Information -->
        <div class="form-section" id="section1">
          <div class="section-header">
            <div class="section-icon" style="background: var(--primary-600);">
              <i class="fas fa-store"></i>
            </div>
            <h2 class="section-title">Store Information</h2>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="storeId">Store ID</label>
            <select class="form-select" id="storeId" onchange="updateProgress()">
              <option value="">Select Store</option>
              <option value="001">Store #001 - Downtown</option>
              <option value="003">Store #003 - Mall Plaza</option>
              <option value="007">Store #007 - Westside</option>
              <option value="012">Store #012 - Northgate</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="auditType">Audit Type</label>
            <select class="form-select" id="auditType" onchange="updateProgress()">
              <option value="">Select Type</option>
              <option value="routine">Routine Inspection</option>
              <option value="compliance">Compliance Check</option>
              <option value="inventory">Inventory Audit</option>
              <option value="pricing">Pricing Verification</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="auditorName">Auditor Name</label>
            <input type="text" class="form-input" id="auditorName" placeholder="Enter your name" value="John Doe" onchange="updateProgress()">
          </div>
          
          <div class="form-group">
            <label class="form-label" for="auditDate">Audit Date</label>
            <input type="date" class="form-input" id="auditDate" onchange="updateProgress()">
          </div>
        </div>

        <!-- Compliance Checklist -->
        <div class="form-section" id="section2">
          <div class="section-header">
            <div class="section-icon" style="background: var(--success-600);">
              <i class="fas fa-clipboard-check"></i>
            </div>
            <h2 class="section-title">Compliance Checklist</h2>
          </div>
          
          <div class="checkbox-group">
            <div class="checkbox-item" onclick="toggleCheckbox(this, 'cleanliness')">
              <input type="checkbox" class="checkbox-input" id="cleanliness">
              <label class="checkbox-label" for="cleanliness">Store cleanliness and hygiene standards</label>
              <span class="checkbox-status status-na">N/A</span>
            </div>
            
            <div class="checkbox-item" onclick="toggleCheckbox(this, 'signage')">
              <input type="checkbox" class="checkbox-input" id="signage">
              <label class="checkbox-label" for="signage">Proper signage and price displays</label>
              <span class="checkbox-status status-na">N/A</span>
            </div>
            
            <div class="checkbox-item" onclick="toggleCheckbox(this, 'safety')">
              <input type="checkbox" class="checkbox-input" id="safety">
              <label class="checkbox-label" for="safety">Safety equipment and emergency exits</label>
              <span class="checkbox-status status-na">N/A</span>
            </div>
            
            <div class="checkbox-item" onclick="toggleCheckbox(this, 'inventory')">
              <input type="checkbox" class="checkbox-input" id="inventory">
              <label class="checkbox-label" for="inventory">Inventory organization and stock levels</label>
              <span class="checkbox-status status-na">N/A</span>
            </div>
            
            <div class="checkbox-item" onclick="toggleCheckbox(this, 'staff')">
              <input type="checkbox" class="checkbox-input" id="staff">
              <label class="checkbox-label" for="staff">Staff training and customer service</label>
              <span class="checkbox-status status-na">N/A</span>
            </div>
          </div>
        </div>

        <!-- Photo Documentation -->
        <div class="form-section" id="section3">
          <div class="section-header">
            <div class="section-icon" style="background: var(--warning-600);">
              <i class="fas fa-camera"></i>
            </div>
            <h2 class="section-title">Photo Documentation</h2>
          </div>
          
          <div class="photo-upload" onclick="addPhoto()" id="photoUpload">
            <div class="upload-icon">
              <i class="fas fa-camera-retro"></i>
            </div>
            <div class="upload-text">Take or upload photos</div>
            <div class="upload-subtext">Document any issues or compliance items</div>
            
            <div class="photo-grid" id="photoGrid" style="display: none;">
              <!-- Photos will be added here -->
            </div>
          </div>
        </div>

        <!-- Notes and Comments -->
        <div class="form-section" id="section4">
          <div class="section-header">
            <div class="section-icon" style="background: #8b5cf6;">
              <i class="fas fa-sticky-note"></i>
            </div>
            <h2 class="section-title">Notes & Comments</h2>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="observations">Observations</label>
            <textarea class="form-textarea" id="observations" placeholder="Record any observations, issues, or recommendations..." onchange="updateProgress()"></textarea>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="recommendations">Recommendations</label>
            <textarea class="form-textarea" id="recommendations" placeholder="Suggest improvements or corrective actions..." onchange="updateProgress()"></textarea>
          </div>
          
          <div class="form-group">
            <label class="form-label" for="priority">Priority Level</label>
            <select class="form-select" id="priority" onchange="updateProgress()">
              <option value="">Select Priority</option>
              <option value="low">Low - Minor issues</option>
              <option value="medium">Medium - Moderate attention needed</option>
              <option value="high">High - Immediate action required</option>
              <option value="critical">Critical - Urgent compliance issue</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="form-actions">
        <button class="action-btn btn-secondary" onclick="saveAsDraft()">
          <i class="fas fa-save" style="margin-right: var(--space-2);"></i>
          Save Draft
        </button>
        <button class="action-btn btn-primary" onclick="submitAudit()" id="submitBtn" disabled>
          <i class="fas fa-check" style="margin-right: var(--space-2);"></i>
          Submit Audit
        </button>
      </div>

      <!-- Floating Scan Button -->
      <button class="floating-scan" onclick="openScanner()">
        <i class="fas fa-qrcode" style="font-size: var(--text-xl);"></i>
      </button>
    </div>

    <script>
      let photoCount = 0;
      let currentProgress = 0;
      
      // Set today's date as default
      document.getElementById('auditDate').value = new Date().toISOString().split('T')[0];
      
      function goBack() {
        if (confirm('Are you sure you want to leave? Any unsaved changes will be lost.')) {
          window.location.href = 'dashboard.html';
        }
      }
      
      function updateProgress() {
        const storeId = document.getElementById('storeId').value;
        const auditType = document.getElementById('auditType').value;
        const auditorName = document.getElementById('auditorName').value;
        const auditDate = document.getElementById('auditDate').value;
        const observations = document.getElementById('observations').value;
        const priority = document.getElementById('priority').value;
        
        const checkedItems = document.querySelectorAll('.checkbox-input:checked').length;
        
        let progress = 0;
        let step = 1;
        let stepText = 'Store Information';
        
        // Step 1: Store Information (25%)
        if (storeId && auditType && auditorName && auditDate) {
          progress = 25;
          step = 2;
          stepText = 'Compliance Checklist';
        }
        
        // Step 2: Compliance Checklist (50%)
        if (progress >= 25 && checkedItems >= 3) {
          progress = 50;
          step = 3;
          stepText = 'Photo Documentation';
        }
        
        // Step 3: Photo Documentation (75%)
        if (progress >= 50 && photoCount >= 1) {
          progress = 75;
          step = 4;
          stepText = 'Notes & Comments';
        }
        
        // Step 4: Notes & Comments (100%)
        if (progress >= 75 && observations && priority) {
          progress = 100;
          stepText = 'Ready to Submit';
        }
        
        document.getElementById('progressFill').style.width = progress + '%';
        document.getElementById('progressText').textContent = `Step ${step} of 4 - ${stepText}`;
        
        // Enable submit button when form is complete
        const submitBtn = document.getElementById('submitBtn');
        if (progress === 100) {
          submitBtn.disabled = false;
          submitBtn.style.background = 'var(--success-600)';
        } else {
          submitBtn.disabled = true;
          submitBtn.style.background = 'var(--neutral-300)';
        }
        
        currentProgress = progress;
      }
      
      function toggleCheckbox(item, checkboxId) {
        const checkbox = document.getElementById(checkboxId);
        const status = item.querySelector('.checkbox-status');
        
        if (!checkbox.checked) {
          checkbox.checked = true;
          item.classList.add('checked');
          status.textContent = 'PASS';
          status.className = 'checkbox-status status-pass';
        } else {
          // Cycle through: PASS -> FAIL -> N/A -> unchecked
          if (status.textContent === 'PASS') {
            status.textContent = 'FAIL';
            status.className = 'checkbox-status status-fail';
          } else if (status.textContent === 'FAIL') {
            status.textContent = 'N/A';
            status.className = 'checkbox-status status-na';
          } else {
            checkbox.checked = false;
            item.classList.remove('checked');
            status.textContent = 'N/A';
            status.className = 'checkbox-status status-na';
          }
        }
        
        updateProgress();
      }
      
      function addPhoto() {
        photoCount++;
        const photoGrid = document.getElementById('photoGrid');
        const photoUpload = document.getElementById('photoUpload');
        
        if (photoCount === 1) {
          photoGrid.style.display = 'grid';
          photoUpload.classList.add('has-photos');
        }
        
        const photoItem = document.createElement('div');
        photoItem.className = 'photo-item';
        photoItem.innerHTML = `
          <i class="fas fa-image photo-placeholder"></i>
          <button class="remove-photo" onclick="removePhoto(this)">
            <i class="fas fa-times"></i>
          </button>
        `;
        
        photoGrid.appendChild(photoItem);
        updateProgress();
        showToast('Photo added successfully');
      }
      
      function removePhoto(button) {
        const photoItem = button.parentElement;
        photoItem.remove();
        photoCount--;
        
        if (photoCount === 0) {
          document.getElementById('photoGrid').style.display = 'none';
          document.getElementById('photoUpload').classList.remove('has-photos');
        }
        
        updateProgress();
        showToast('Photo removed');
      }
      
      function openScanner() {
        window.location.href = 'scan-screen.html';
      }
      
      function saveAsDraft() {
        showToast('Audit saved as draft');
        // In a real app, this would save to local storage or server
      }
      
      function submitAudit() {
        if (currentProgress < 100) {
          showToast('Please complete all required fields');
          return;
        }
        
        // Show loading state
        const submitBtn = document.getElementById('submitBtn');
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin" style="margin-right: var(--space-2);"></i>Submitting...';
        submitBtn.disabled = true;
        
        // Simulate submission
        setTimeout(() => {
          showToast('Audit submitted successfully!');
          setTimeout(() => {
            window.location.href = 'dashboard.html';
          }, 1500);
        }, 2000);
      }
      
      function showToast(message) {
        const toast = document.createElement('div');
        toast.style.cssText = `
          position: fixed;
          top: 100px;
          left: 50%;
          transform: translateX(-50%);
          background: var(--neutral-800);
          color: var(--neutral-0);
          padding: var(--space-3) var(--space-4);
          border-radius: var(--radius-lg);
          font-size: var(--text-sm);
          font-weight: var(--font-medium);
          z-index: 100;
          animation: slideDown 0.3s ease;
        `;
        toast.textContent = message;
        document.body.appendChild(toast);
        
        setTimeout(() => {
          if (document.body.contains(toast)) {
            document.body.removeChild(toast);
          }
        }, 3000);
      }
      
      // Initialize progress on page load
      document.addEventListener('DOMContentLoaded', function() {
        updateProgress();
      });
    </script>
  </body>
</html>
